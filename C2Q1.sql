CREATE TABLE  SAILORS
( 
SID INT(5),
SNAME VARCHAR(10),
RATING INT(5),
AGE INT(2)
);
INSERT INTO SAILORS VALUES
(22,'DUSTIN',7,45),(29,'BRUTAS',1,33),(31,'LUBBER',8,55),
(32,'ANDY',8,25),(58,'RUSTY',10,35),(64,'HORATIO',7,35),
(71,'ZORBA',10,16),(74,'HORATIO',9,35),(85,'ART',3,26),
(95,'BOB',3,64);
DESCRIBE SAILORS;
SELECT *FROM SAILORS;
DROP TABLE SAILORS;

CREATE TABLE BOATS
( 
BID INT(5),
BNAME VARCHAR(10),
COLOR VARCHAR(8)
);
INSERT INTO BOATS VALUES  (101,'INTERLAKE','BLUE'),
(102,'INTERLAKE','RED'),(103,'CLIPPER','GREEN'),(104,'MARINE','RED');
DESCRIBE BOATS;
SELECT *FROM BOATS;
DROP TABLE BOATS;

CREATE TABLE RESERVES (
SID INT(5),
BID INT(5),
DAY date
);
INSERT INTO RESERVES VALUES(22,101,"1998-10-10"),(22,102,"1998-10-10"),(22,103,"1998-08-10"),(22,104,"1998-07-10"),
(31,102,"1998-10-11"),(31,103,"1998-06-11"),(31,104,"1998-12-11"),(64,101,"1998-05-09"),(64,102,"1998-08-09"),(74,103,"1998-08-09");
DESCRIBE  RESERVES ;
SELECT *FROM  RESERVES ;
DROP TABLE RESERVES;
SELECT SNAME,AGE FROM SAILORS;

SELECT SAILORS.SNAME,SAILORS.AGE,BOATS.BNAME,BOATS.COLOR,RESERVES.DAY FROM((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE RESERVES.BID=101;

SELECT *FROM SAILORS WHERE RATING>7;

SELECT SAILORS.SNAME FROM((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE RESERVES.BID=103;
 
 SELECT DISTINCT SAILORS.SNAME,SAILORS.AGE FROM((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE BOATS.COLOR="RED" ORDER BY SAILORS.AGE DESC;
 
  SELECT DISTINCT SAILORS.SNAME FROM((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE BOATS.COLOR="RED" OR "GREEN" ;
 
 SELECT DISTINCT BOATS.COLOR FROM ((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE SAILORS.SNAME="LUBBER";
 
  SELECT DISTINCT SAILORS.SNAME FROM((SAILORS INNER JOIN RESERVES ON SAILORS.SID=RESERVES.SID)
 INNER JOIN BOATS ON RESERVES.BID=BOATS.BID) WHERE BOATS.COLOR="RED" AND "GREEN" ;
 
  SELECT DISTINCT SNAME FROM SAILORS,RESERVES WHERE RESERVES.SID=SAILORS.SID;
 
 SELECT SNAME , RESERVES.SID FROM RESERVES,SAILORS WHERE SAILORS.SID=RESERVES.SID GROUP BY DAY, RESERVES.SID,SNAME HAVING COUNT(DAY)>1;
 
 SELECT * FROM SAILORS WHERE AGE=(SELECT MIN(AGE) FROM SAILORS);
 
SELECT SNAME,RATING FROM SAILORS WHERE RATING>(SELECT MAX(RATING) FROM SAILORS WHERE SNAME="HORATIO");
 
 SELECT SNAME,SID FROM (SELECT SNAME,RESERVES.SID,COUNT(BID) AS ID FROM RESERVES,SAILORS WHERE RESERVES.SID=SAILORS.SID GROUP BY
 RESERVES.SID,SNAME) A WHERE ID=(SELECT COUNT(BID)FROM  BOATS);

 SELECT DISTINCT COUNT(SNAME) FROM SAILORS;
 
 SELECT AVG(AGE) FROM SAILORS;
 
 SELECT RATING, AVG(AGE) FROM SAILORS GROUP BY RATING;
 
SELECT A.RATING, B.MEAN FROM (SELECT COUNT(SNAME) AS NUM,RATING FROM SAILORS GROUP BY RATING HAVING COUNT(SNAME)>1)A,(SELECT RATING,AVG(AGE) AS MEAN FROM SAILORS GROUP 
BY RATING) B WHERE A.RATING=B.RATING;
  
 